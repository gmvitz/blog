---
draft: true
title: Working with EIA Data
author: Gregory Vitz
date: '2019-05-29'
slug: working-with-eia-data
categories: []
tags: []
Categories:
  - r
Description: ''
Tags:
  - r
  - eia
menu: ''
---

The United States Energy Information Administration (EIA) offers thousands of free data sets publicly, and they can all be found on their website [here](https://www.eia.gov/electricity/data/eia860/). I believe that each of the datasets can be downloaded as a CSV, however there is also an option to access the data through the EIA API. Today, I will be working with some data that I manually downloaded from the EIA website with generator level information. A future post may address how to use the EIA API to programatically get the data. 

```{r message=FALSE}
library(tidyverse)
library(readxl)
library(here)
```

Using `readxl` we can easily import the data downloaded from EIA. I used two separate pipes to handle some extra notes added at the bottom of the 

```{r}
file <- here("static", "data", "eia8602018er", "3_1_Generator_Y2018_Early_Release.xlsx")
plant_file <- here("static", "data", "eia8602018er", "2___Plant_Y2018_Early_Release.xlsx")


operable <- "Operable" %>%  
    set_names() %>% 
    read_excel(skip = 2, path = file, guess_max = 20000, n_max = 22050)

retired <- "Retired and Canceled" %>%  
    set_names() %>% 
    read_excel(skip = 2, path = file, guess_max = 4000, n_max = 4324)

plant <- "Plant" %>% 
  set_names() %>% 
  read_excel(skip = 2, path = plant_file, guess_max = 4000, n_max = 4324) %>% 
  select(`Plant Code`, `Balancing Authority Code`)

glimpse(operable)
```

As you can see there are a ton of variables in this data. Since we plan on doing an analysis of added and lost capacity we will only need a few.

```{r}
# Units that began operation in 2018
operable2018 <- operable %>% 
    filter(`Operating Year` == 2018) %>%
    transmute(`Plant Code`, 
              `Nameplate Capacity (MW)`, 
              `Energy Source 1`,
              status = 1)

# Units that retired in 2018
retired2018 <- retired %>% 
    filter(`Retirement Year` == 2018) %>% 
    transmute(`Plant Code`, 
              `Nameplate Capacity (MW)`, 
              `Energy Source 1`,
              status = 0)

all_data <- bind_rows(operable2018, retired2018) %>% 
    left_join(plant, by = "Plant Code")
```

We joined the plant data with 

```{r}

```

